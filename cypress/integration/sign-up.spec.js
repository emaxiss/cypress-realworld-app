describe('sign up', () => {
  const data = {
    firstName: 'Mike',
    lastName: 'C',
    username: Date.now(),
    password: 'password',
    baseUrl: Cypress.config('baseUrl')
  }
  before('setup routes', () => {
    cy.server()
    cy.route('POST', '/users')
      .as('createUser')
    cy.route('POST', '/login')
      .as('login')
    cy.route('GET', '/bankAccounts')
      .as('getBankAccounts')
    cy.route('GET', '/transactions/public')
      .as('getPublicTransactions')
    cy.route('GET', '/notifications')
      .as('getNotifications')
  })
  it('sign up, login as new user, see dialog', () => {
    cy.visit('signup')
    cy.get('#firstName')
      .type(data.firstName)
    cy.get('#lastName')
      .type(data.lastName)
    cy.get('#username')
      .type(data.username)
    cy.get('#password')
      .type(data.password)
    cy.get('#confirmPassword')
      .type(data.password)
    cy.contains('button', 'Sign Up')
      .click()
    cy.wait('@createUser')
    cy.get('#username')
      .type(data.username)
    cy.get('#password')
      .type(data.password)
    cy.contains('button', 'Sign In')
      .click()
    cy.wait('@login')
    cy.location('pathname')
      .should('equal', '/')
    cy.wait('@getBankAccounts')
    cy.wait('@getPublicTransactions')
    cy.wait('@getNotifications')
    cy.contains('[role=dialog]', 'Get Started with Real World App')
      .should('be.visible')
  })
})